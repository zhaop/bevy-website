


  



  
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  





  
    
  



  



  



<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="Bevy 0.4" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://bevyengine.org&#x2F;&#x2F;news&#x2F;bevy-0-4&#x2F;" />
    <meta property="og:image"
          content="https://bevyengine.org/assets/bevy_logo_fill.png" />
    <meta property="og:description"
          content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!" />
    <link rel="shortcut icon" type="image/png" href="/assets/favicon.png">
    <link rel="stylesheet" href="/site.css" />
    <link href="/atom.xml" rel="alternate" type="application/atom+xml" />
    

    <title>Bevy 0.4</title>
    
  </head>
  <body>
    <div class="layout">
      <input id="mobile-menu-state" class="hidden" type="checkbox">
      <header class="layout__header header print:hidden" data-mobile-menu-state-container>
        <div class="header__content">
          <label class="main-menu-backdrop" for="mobile-menu-state"></label>
          <label class="header__hamburger button-square button-square--header"
                  for="mobile-menu-state">
            <img src="/assets/icon-hamburger.svg"
                  alt="Three horizontal lines stacked on top of eachother"
                  width="20"
                  height="16">
          </label>
          <div class="header__left-block">
            <a class="header__logo" href="/">
              <img class="logo"
                    src="/assets/bevy_logo_dark.svg"
                    alt="Bevy Engine"
                    width="520"
                    height="130">
            </a>
            <div class="header__message">
              
  
    
      News
    
  

            </div>
          </div>
          
  <input id="page-menu-switch-state" class="hidden" type="checkbox" checked>

          <nav class="header__menu main-menu main-menu--with-page-menu"
                role="navigation"
                data-page-menu-switch-state-container>
            <div class="main-menu__header">
              <a href="/">
                <img class="logo"
                      src="/assets/bevy_logo_dark.svg"
                      alt="Bevy Engine"
                      width="520"
                      height="130">
              </a>
              <label class="button-square button-square--header" for="mobile-menu-state">
                <img src="/assets/icon-times.svg"
                      alt="A saltire or x-cross"
                      width="16"
                      height="16">
              </label>
            </div>
            
  <div class="main-menu__page-menu-switch">
    <label class="menu-switch" for="page-menu-switch-state">
      <div class="menu-switch__option menu-switch__option--main-menu">Main Menu</div>
      <div class="menu-switch__option menu-switch__option--page-menu">
        Post
      </div>
    </label>
  </div>

            <div class="main-menu__content">
              <div class="main-menu__page-menu">
                
  
    <ul class="tree-menu">
      
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#wasm-webgl2">WASM + WebGL2</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#cross-platform-main-function">Cross Platform Main Function</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#live-shader-reloading">Live Shader Reloading</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#ecs-improvements">ECS Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#states">States</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#gltf-improvements">GLTF Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#spawn-scenes-as-children">Spawn Scenes as Children</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#dynamic-linking">Dynamic Linking</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#text-layout-improvements">Text Layout Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#renderer-optimization">Renderer Optimization</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#reflection">Reflection</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#3d-texture-assets">3D Texture Assets</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#logging-and-profiling">Logging and Profiling</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#hidpi">HIDPI</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#timer-improvements">Timer Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#task-system-improvements">Task System Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#apple-silicon-support">Apple Silicon Support</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#new-examples">New Examples</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#change-log">Change Log</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#contributors">Contributors</a>
      
    </div>
    
  </li>

    </ul>
  

              </div>
              <ul class="main-menu__menu">
                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry main-menu__entry--getting-started">
    <a href="&#x2F;learn&#x2F;quick-start&#x2F;getting-started" class="main-menu__link">
      <span>Getting Started</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry ">
    <a href="&#x2F;learn" class="main-menu__link">
      <span>Learn</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
    
  
  <li class="main-menu__entry ">
    <a href="&#x2F;news" class="main-menu__link main-menu__link--active">
      <span>News</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry ">
    <a href="&#x2F;community" class="main-menu__link">
      <span>Community</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry ">
    <a href="&#x2F;foundation" class="main-menu__link">
      <span>Foundation</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry ">
    <a href="&#x2F;assets" class="main-menu__link">
      <span>Assets</span>
    </a>
  </li>

                
  
  
  
    
  
  
  
  
  
  <li class="main-menu__entry ">
    <a href="&#x2F;examples" class="main-menu__link">
      <span>Examples</span>
    </a>
  </li>

                
              </ul>
            </div>
          </nav>
          <div class="header__cta-container">
            <a class="button button--pink header__cta" href="/donate">Donate
              <img class="button__icon"
                    src="/assets/heart.svg"
                    alt="heart icon"
                    width="512"
                    height="512" />
            </a>
            <a class="header__cta header__cta--github"
                href="https://github.com/bevyengine/bevy">
              <img src="/assets/github-mark-white.svg"
                    alt="GitHub repo"
                    width="98"
                    height="96" />
            </a>
          </div>
        </div>
      </header>
      <main class="layout__content">
        <div class="container">
          
            
  
    
    
  
    
    
  

  

  

          
          
  <div class="page-with-menu page-with-menu--news">
    <div class="page-with-menu__menu-wrapper print:hidden">
      <div class="page-with-menu__menu">
        
  
    <ul class="tree-menu">
      
  
  
  
  
  
  
    
    <input id="news-menu-1-wasm-webgl2" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#wasm-webgl2">WASM + WebGL2</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-wasm-webgl2">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#bevy-webgl2-showcase">Bevy WebGL2 Showcase</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#cross-platform-main-function">Cross Platform Main Function</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#live-shader-reloading">Live Shader Reloading</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-ecs-improvements" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#ecs-improvements">ECS Improvements</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-ecs-improvements">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#flexible-ecs-parameters">Flexible ECS Parameters</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#simplified-query-filters">Simplified Query Filters</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#system-inputs-outputs-and-chaining">System Inputs, Outputs, and Chaining</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#schedule-v2">Schedule V2</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#deprecated-for-each-systems">Deprecated For-Each Systems</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#states">States</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#gltf-improvements">GLTF Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#spawn-scenes-as-children">Spawn Scenes as Children</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-dynamic-linking" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#dynamic-linking">Dynamic Linking</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-dynamic-linking">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#time-to-compile-change-to-3d-scene-example-in-seconds-less-is-better">Time To Compile Change To 3d_scene Example (in seconds, less is better)</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#text-layout-improvements">Text Layout Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-renderer-optimization" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#renderer-optimization">Renderer Optimization</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-renderer-optimization">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#incrementalize-everything">Incrementalize Everything</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#optimize-text-rendering-and-other-immediate-rendering">Optimize Text Rendering (and other immediate rendering)</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#mailbox-vsync">Mailbox Vsync</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-reflection" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#reflection">Reflection</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-reflection">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#interact-with-fields-using-their-names">Interact with Fields Using Their Names</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#patch-your-types-with-new-values">Patch Your Types With New Values</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#look-up-nested-fields-using-path-strings">Look Up Nested Fields Using &quot;Path Strings&quot;</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#iterate-over-struct-fields">Iterate Over Struct Fields</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#automatically-serialize-and-deserialize-with-serde">Automatically Serialize And Deserialize With Serde</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#trait-reflection">Trait Reflection</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#3d-texture-assets">3D Texture Assets</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-logging-and-profiling" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#logging-and-profiling">Logging and Profiling</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-logging-and-profiling">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#logging">Logging</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#profiling">Profiling</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#hidpi">HIDPI</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#timer-improvements">Timer Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#task-system-improvements">Task System Improvements</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#apple-silicon-support">Apple Silicon Support</a>
      
    </div>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-new-examples" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#new-examples">New Examples</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-new-examples">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#bevy-contributors">Bevy Contributors</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#bevymark">BevyMark</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
    
    <input id="news-menu-1-change-log" class="tree-menu__state" type="checkbox" checked>
  
  <li class="tree-menu__item">
    <div class="tree-menu__label tree-menu__label--with-chevron">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#change-log">Change Log</a>
      
        <label class="tree-menu__toggle" for="news-menu-1-change-log">
          <img class="tree-menu__chevron"
                src="/assets/icon-chevron-down.svg"
                alt="A chevron, or V-shaped symbol"
                width="15"
                height="24" />
        </label>
      
    </div>
    
      <ul class="tree-menu">
        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#added">Added</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#changed">Changed</a>
      
    </div>
    
  </li>

        
          
  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#fixed">Fixed</a>
      
    </div>
    
  </li>

        
      </ul>
    
  </li>

  
  
  
  
  
  
  <li class="tree-menu__item">
    <div class="tree-menu__label">
      <a class="tree-menu__link" href="https://bevyengine.org/news/bevy-0-4/#contributors">Contributors</a>
      
    </div>
    
  </li>

    </ul>
  

      </div>
    </div>
    <div class="page-with-menu__content">
      
  <h1 class="news-title">Bevy 0.4</h1>
  <h2 class="news-subtitle">
    Posted on December 19, 2020 by Carter Anderson
    
      <span class="news-social-links">
        (
        
          <img src="/assets/github_grey.svg"
                class="news-social-icon"
                alt="A silhouette of a figure with cat ears waving a tentacle, or Octocat: GitHub's mascot and logo"
                width="496"
                height="512" />
          <span class="media-content">
            <a class="news-social-link"
                href="https://www.github.com/cart">@cart</a></span>
        
        
          <img src="/assets/twitter_grey.svg"
                class="news-social-icon"
                alt="A vector art of a grey bird flying; former logo of X (formerly Twitter)"
                width="512"
                height="512" />
          <span class="media-content">
            <a class="news-social-link"
                href="https://www.twitter.com/cart_cart">@cart_cart</a>
          </span>
        
        
          <img src="/assets/youtube_grey.svg"
                class="news-social-icon"
                alt="A triangle pointing right in a rounded rectangle; Youtube's logo"
                width="576"
                height="512" />
          <span class="media-content">
            <a class="news-social-link"
                href="https://www.youtube.com/cartdev">cartdev</a>
          </span>
        
        )
      </span>
    
  </h2>
  
    <div class="media-content news-content">
      
        <img src="colonize.png"
              alt="Screenshot of Colonize: a Dwarf-Fortress&#x2F;Rimworld-like game being developed in Bevy by @indiv0"
              width="926"
              height="521" />
      
      
        
          <div class="news-image-subtitle">
            <a href="https:&#x2F;&#x2F;github.com&#x2F;indiv0&#x2F;colonize&#x2F;">Screenshot of Colonize: a Dwarf-Fortress&#x2F;Rimworld-like game being developed in Bevy by @indiv0</a>
          </div>
        
      
    </div>
  
  <div class="media-content news-content">
    <p>A little over a month after releasing Bevy 0.3, and thanks to <strong>66</strong> contributors, <strong>178</strong> pull requests, and our <a href="https://github.com/sponsors/cart"><strong>generous sponsors</strong></a>, I'm happy to announce the <strong>Bevy 0.4</strong> release on <a href="https://crates.io/crates/bevy">crates.io</a>!</p>
<p>For those who don't know, Bevy is a refreshingly simple data-driven game engine built in Rust. You can check out <a href="/learn/quick-start/introduction">The Quick Start Guide</a> to get started. Bevy is also free and open source forever! You can grab the full <a href="https://github.com/bevyengine/bevy">source code</a> on GitHub.</p>
<p>Here are some of the highlights from this release:</p>
<span id="continue-reading"></span><h2 id="wasm-webgl2">WASM + WebGL2
<a class="anchor-link" href="#wasm-webgl2">#</a>
</h2>
<div class="release-feature-authors">authors: @mrk-its</div>
<p>Bevy now has a WebGL2 render backend! @mrk-its has been hard at work building the <a href="https://github.com/mrk-its/bevy_webgl2">Bevy WebGL2 Plugin</a> and expanding <code>bevy_render</code> to meet the needs of the web. He also put together a nice website showcasing various Bevy examples and games running on the web.</p>
<p>I think the results speak for themselves:</p>
<h3 id="bevy-webgl2-showcase"><a href="https://mrk.sed.pl/bevy-showcase/">Bevy WebGL2 Showcase</a>
<a class="anchor-link" href="#bevy-webgl2-showcase">#</a>
</h3>
<p><a href="https://mrk.sed.pl/bevy-showcase/"><img src="https://bevyengine.org/news/bevy-0-4/webgl_showcase.png" alt="webgl2 showcase" /></a></p>
<h2 id="cross-platform-main-function">Cross Platform Main Function
<a class="anchor-link" href="#cross-platform-main-function">#</a>
</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>On most supported Bevy platforms you can just use normal main functions (ex: Windows, MacOS, Linux, and Web). Here is the smallest possible Bevy app that runs on those platforms:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">prelude<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>build<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>However some platforms (currently Android and iOS) require additional boilerplate. This arcane magic is error prone, takes up space, and isn't particularly nice to look at. Up until this point, Bevy users had to supply their own boilerplate ... but no more! <strong>Bevy 0.4</strong> adds a new <code>#[bevy_main]</code> proc-macro, which inserts the relevant boilerplate for you. This is a big step toward our &quot;write once run anywhere&quot; goal.</p>
<p>This Bevy App has all the code required to run on Windows, MacOS, Linux, Android, iOS, and Web:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">prelude<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">bevy_main</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>build<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h2 id="live-shader-reloading">Live Shader Reloading
<a class="anchor-link" href="#live-shader-reloading">#</a>
</h2>
<div class="release-feature-authors">authors: @yrns</div>
<p>Bevy can now update changes to shaders at runtime, giving you instant feedback without restarting your app. This video isn't sped up!</p>
<p><video controls loop><source  src="hot_shader_reloading.mp4" type="video/mp4"/></video></p>
<h2 id="ecs-improvements">ECS Improvements
<a class="anchor-link" href="#ecs-improvements">#</a>
</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>It wouldn't be a Bevy update without another round of ECS improvements!</p>
<h3 id="flexible-ecs-parameters">Flexible ECS Parameters
<a class="anchor-link" href="#flexible-ecs-parameters">#</a>
</h3>
<p>Prior versions of Bevy forced you to provide system parameters in a specific order:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> This system followed the [Commands][Resources][Queries] order and compiled as expected
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">valid_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">commands</span><span class="z-punctuation z-separator z-rust">:</span> Commands, <span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> This system did not follow the required ordering, which caused compilation to fail
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">invalid_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">commands</span><span class="z-punctuation z-separator z-rust">:</span> Commands, <span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>Newbies would fall prey to this constantly. These completely arbitrary constraints were a quirk of the internal implementation. The <code>IntoSystem</code> trait was only implemented for specific orders. Supporting every order would have exponentially affected compile times. The internal implementation was also constructed with a <a href="https://github.com/bevyengine/bevy/blob/9afe196f1690a6a6e47bf67ac740b4edeffd97bd/crates/bevy_ecs/src/system/into_system.rs#L158">famously complicated macro</a>.</p>
<p>To resolve this, I completely rewrote how we generate systems. We now use a <code>SystemParam</code> trait, which we implement for each parameter type. This has a number of benefits:</p>
<ul>
<li><strong>Significantly Faster Compile Times</strong>: We're seeing a <b style="color: rgb(50, 210, 50)">~25%</b> decrease in clean compile times</li>
<li><strong>Use Any Parameter Order You Want</strong>: No more arbitrary order restrictions!</li>
<li><strong>Easily Add New Parameters</strong>: It is now easy for us (and for users) to create new parameters. Just implement the <code>SystemParam</code> trait!</li>
<li><strong>Simpler Implementation</strong>: The new implementation is much smaller and also way easier to maintain and understand.</li>
</ul>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> In Bevy 0.4 this system is now perfectly valid. Cool!
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">commands</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> Commands, <span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>Notice that in <strong>Bevy 0.4</strong>, commands now look like <code>commands: &amp;mut Commands</code> instead of <code>mut commands: Commands</code>.</p>
<h3 id="simplified-query-filters">Simplified Query Filters
<a class="anchor-link" href="#simplified-query-filters">#</a>
</h3>
<p>Up until now, Bevy's Query filters were intermingled with components:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>A, <span class="z-meta z-generic z-rust">Without<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>B, <span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform, <span class="z-meta z-generic z-rust">Changed<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Velocity<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>Confused? You wouldn't be the first! You can interpret the query above as &quot;give me immutable references to the <code>Transform</code> and <code>Velocity</code> components of all entities that have the <code>A</code> component, <em>do not</em> have the <code>B</code> component, and have a changed Velocity component&quot;.</p>
<p>First, the nesting of types via With / Without makes it very unclear whats going on. Additionally, it's hard to tell what the <code>Changed&lt;Velocity&gt;</code> parameter does. Is it just a filter? Does it also return a Velocity component? If so, is it immutable or mutable?</p>
<p>It made sense to break up these concepts. In <strong>Bevy 0.4</strong>, Query filters are separate from Query components. The query above looks like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Query with filters
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform, <span class="z-keyword z-operator z-rust">&amp;</span>Velocity<span class="z-punctuation z-section z-group z-end z-rust">)</span>, <span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>A<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-meta z-generic z-rust">Without<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>B<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-meta z-generic z-rust">Changed<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Velocity<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Query without filters
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform, <span class="z-keyword z-operator z-rust">&amp;</span>Velocity<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>This makes it much easier to tell what a Query is doing at a glance. It also makes for more composable behaviors. For example, you can now filter on <code>Changed&lt;Velocity&gt;</code> without actually retrieving the <code>Velocity</code> component.</p>
<p>And now that filters are a separate type, you can create type aliases for filters that you want to re-use:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">ChangedVelocity</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>A<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-generic z-rust">Without<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>B<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-generic z-rust">Changed<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Velocity<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform, <span class="z-keyword z-operator z-rust">&amp;</span>Velocity<span class="z-punctuation z-section z-group z-end z-rust">)</span>, ChangedVelocity<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h3 id="system-inputs-outputs-and-chaining">System Inputs, Outputs, and Chaining
<a class="anchor-link" href="#system-inputs-outputs-and-chaining">#</a>
</h3>
<p>Systems can now have inputs and outputs. This opens up a variety of interesting behaviors, such as system error handling:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>build<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>result_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">chain</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>error_handler<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">result_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-keyword z-operator z-rust">&amp;</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Result</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> transform <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">SOME_ENTITY</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-keyword z-operator z-rust">?</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>found entity transform: <span class="z-constant z-other z-placeholder z-rust">{:?}</span><span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> transform<span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">error_handler_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>In<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-variable z-parameter z-rust">result</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>: <span class="z-meta z-generic z-rust">In<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Result</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">error_handler</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>MyErrorHandler<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Err</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>err</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> result <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">      error_handler<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">handle_error</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>err</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">  </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>The <a href="https://docs.rs/bevy/0.4.0/bevy/prelude/trait.System.html"><code>System</code></a> trait now looks like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Has no inputs and no outputs
</span></span><span class="z-source z-rust"><span class="z-meta z-generic z-rust">System<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>In = <span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span>, Out = <span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Takes a usize as input and return a f32
</span></span><span class="z-source z-rust"><span class="z-meta z-generic z-rust">System<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>In = <span class="z-storage z-type z-rust">usize</span>, Out = <span class="z-storage z-type z-rust">f32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>
</span></code></pre>
<p>We use this feature in our new Schedule implementation.</p>
<h3 id="schedule-v2">Schedule V2
<a class="anchor-link" href="#schedule-v2">#</a>
</h3>
<p>Bevy's old Schedule was nice. System registrations were easy to read and easy to compose. But it also had significant limitations:</p>
<ul>
<li>Only one Schedule allowed</li>
<li>Very static: you were limited to using the tools we gave you:
<ul>
<li>stages are just lists of systems</li>
<li>stages are added to schedules</li>
<li>stages use hard-coded system runners</li>
</ul>
</li>
<li>Couldn't switch between schedules at runtime</li>
<li>Couldn't easily support &quot;fixed timestep&quot; scenarios</li>
</ul>
<p>To solve these problems, I wrote a new Schedule system from scratch. Before you get worried, these are largely <em>non-breaking</em> changes. The high level &quot;app builder&quot; syntax you know and love is still available:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<h4 id="stage-trait">Stage Trait
<a class="anchor-link" href="#stage-trait">#</a>
</h4>
<p>Stages are now a trait. You can now implement your own <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/trait.Stage.html"><code>Stage</code></a> types!</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyStage</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">Stage <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyStage</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">run</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">self</span>, <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> World, <span class="z-variable z-parameter z-rust">resources</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> Resources</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Do stage stuff here.
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> You have unique access to the World and Resources, so you are free to do anything
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h4 id="stage-type-systemstage">Stage Type: <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.SystemStage.html"><code>SystemStage</code></a>
<a class="anchor-link" href="#stage-type-systemstage">#</a>
</h4>
<p>This is basically a &quot;normal&quot; stage. You can add systems to it and you can decide how those systems will be executed (parallel, serial, or custom logic)</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> runs systems in parallel (using the default parallel executor)
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> parallel_stage <span class="z-keyword z-operator z-assignment z-rust">=</span>
</span><span class="z-source z-rust">    <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>parallel<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> runs systems serially (in registration order)
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> serial_stage <span class="z-keyword z-operator z-assignment z-rust">=</span>
</span><span class="z-source z-rust">    <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>serial<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> you can also write your own custom SystemStageExecutor
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> custom_executor_stage <span class="z-keyword z-operator z-assignment z-rust">=</span>
</span><span class="z-source z-rust">    <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">MyCustomExecutor<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h4 id="stage-type-schedule">Stage Type: [<code>Schedule</code>]
<a class="anchor-link" href="#stage-type-schedule">#</a>
</h4>
<p>You read that right! [<code>Schedule</code>] now implements the <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/trait.Stage.html"><code>Stage</code></a> trait, which means you can nest Schedules within other schedules:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> schedule <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">Schedule<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>update<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>parallel<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>nested<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">Schedule<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>nested_stage<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>serial<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.Schedule.html"><code>Schedule</code></a></p>
<h4 id="run-criteria">Run Criteria
<a class="anchor-link" href="#run-criteria">#</a>
</h4>
<p>You can add &quot;run criteria&quot; to any <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.SystemStage.html"><code>SystemStage</code></a> or [<code>Schedule</code>].</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> A &quot;run criteria&quot; is just a system that returns a `ShouldRun` result
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">only_on_10_criteria</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">value</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">usize</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> ShouldRun</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-keyword z-operator z-arithmetic z-rust">*</span>value <span class="z-keyword z-operator z-comparison z-rust">==</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">10</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> 
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-path z-rust">ShouldRun<span class="z-punctuation z-accessor z-rust">::</span></span>Yes 
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> <span class="z-keyword z-control z-rust">else</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> 
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-path z-rust">ShouldRun<span class="z-punctuation z-accessor z-rust">::</span></span>No
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">app
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this stage only runs when Res&lt;usize&gt; has a value of 10
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_stage_after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">stage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">UPDATE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>only_on_10_stage<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>parallel<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_run_criteria</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>only_on_10_criteria<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this stage only runs once
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_stage_after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">stage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">RUN_ONCE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>one_and_done<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">Schedule<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_run_criteria</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">RunOnce<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<h4 id="fixed-timestep">Fixed Timestep
<a class="anchor-link" href="#fixed-timestep">#</a>
</h4>
<p>You can now run stages on a &quot;fixed timestep&quot;.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this stage will run once every 0.4 seconds
</span></span><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_stage_after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">stage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">UPDATE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>fixed_update<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">SystemStage<span class="z-punctuation z-accessor z-rust">::</span></span>parallel<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_run_criteria</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">FixedTimestep<span class="z-punctuation z-accessor z-rust">::</span></span>step<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">4</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>This builds on top of <code>ShouldRun::YesAndLoop</code>, which ensures that the schedule continues to loop until it has consumed all accumulated time.</p>
<p>Check out the excellent <a href="https://gafferongames.com/post/fix_your_timestep/">&quot;Fix Your Timestep!&quot;</a> article if you want to learn more about fixed timesteps.</p>
<h4 id="typed-stage-builders">Typed Stage Builders
<a class="anchor-link" href="#typed-stage-builders">#</a>
</h4>
<p>Now that stages can be any type, we need a way for <a href="https://docs.rs/bevy/0.4.0/bevy/app/trait.Plugin.html"><code>Plugin</code></a> to interact with arbitrary stage types:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">app
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this &quot;high level&quot; builder pattern still works (and assumes that the stage is a SystemStage)
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>some_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this &quot;low level&quot; builder is equivalent to add_system()
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">stage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">UPDATE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">stage</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> SystemStage<span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust">        </span><span class="z-meta z-function z-closure z-rust">stage<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>some_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this works for custom stage types too
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">MY_CUSTOM_STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">stage</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> MyCustomStage<span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust">        </span><span class="z-meta z-function z-closure z-rust">stage<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">do_custom_thing</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<h3 id="deprecated-for-each-systems">Deprecated For-Each Systems
<a class="anchor-link" href="#deprecated-for-each-systems">#</a>
</h3>
<p>Prior versions of Bevy supported &quot;for-each&quot; systems, which looked like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> on each update this system runs once for each entity with a Transform component
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">entity</span><span class="z-punctuation z-separator z-rust">:</span> Entity, <span class="z-variable z-parameter z-rust">transform</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Mut<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> do per-entity logic here
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>From now on, the system above should be written like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> on each update this system runs once and internally iterates over each entity
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Entity, <span class="z-keyword z-operator z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entity<span class="z-punctuation z-separator z-rust">,</span> <span class="z-storage z-modifier z-rust">mut</span> transform</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> do per-entity logic here
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>For-each systems were nice to look at and sometimes saved some typing. Why remove them?</p>
<ol>
<li>For-each systems were fundamentally limited in a number of ways. They couldn't iterate removed components, filter, control iteration, or use multiple queries at the same time. This meant they needed to be converted to &quot;query systems&quot; as soon as those features were needed.</li>
<li>Bevy should generally have &quot;one way to do things&quot;. For-each systems were a slightly more ergonomic way to define a small subset of system types. This forced people to make a &quot;design decision&quot; when they shouldn't need to. It also made examples and tutorials inconsistent according to people's preferences for one or the other.</li>
<li>There were a number of &quot;gotchas&quot; for newcomers that constantly come up in our support forums and confused newbies:
<ul>
<li>users expect <code>&amp;mut T</code> queries to work in foreach systems (ex: <code>fn system(a: &amp;mut A) {}</code>). These can't work because we require <code>Mut&lt;T&gt;</code> tracking pointers to ensure change tracking always works as expected. The equivalent <code>Query&lt;&amp;mut A&gt;</code> works because we can return the tracking pointer when iterating the Query.</li>
<li>A &quot;run this for-each system on some criteria&quot; bug that was common enough that we had to cover it in the Bevy Book.</li>
</ul>
</li>
<li>They increased compile times. Removing for-each systems saved me about ~5 seconds on clean Bevy compiles)</li>
<li>Their internal implementation required a complicated macro. This affected maintainability.</li>
</ol>
<h2 id="states">States
<a class="anchor-link" href="#states">#</a>
</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>By popular demand, Bevy now supports States. These are logical &quot;app states&quot; that allow you to enable/disable systems according to the state your app is in.</p>
<p>States are defined as normal Rust enums:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Clone</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-enum z-rust"><span class="z-storage z-type z-enum z-rust">enum</span> <span class="z-entity z-name z-enum z-rust">AppState</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-enum z-rust"><span class="z-meta z-block z-rust">    Loading<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-enum z-rust"><span class="z-meta z-block z-rust">    Menu<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-enum z-rust"><span class="z-meta z-block z-rust">    InGame
</span></span></span><span class="z-source z-rust"><span class="z-meta z-enum z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>You then add them to your app as a resource like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> add a new AppState resource that defaults to the Loading state
</span></span><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">State<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>Loading</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>To run systems according to the current state, add a <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.StateStage.html"><code>StateStage</code></a>:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_stage_after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">stage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">UPDATE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">StateStage<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>AppState<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>You can then add systems for each state value / lifecycle-event like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">app
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_state_enter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>Menu<span class="z-punctuation z-separator z-rust">,</span> setup_menu<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_state_update</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>Menu<span class="z-punctuation z-separator z-rust">,</span> menu<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_state_exit</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>Menu<span class="z-punctuation z-separator z-rust">,</span> cleanup_menu<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_state_enter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>InGame<span class="z-punctuation z-separator z-rust">,</span> setup_game<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_state_update</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-other z-rust">STAGE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>InGame<span class="z-punctuation z-separator z-rust">,</span> movement<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>Notice that there are different &quot;lifecycle events&quot;:</p>
<ul>
<li><strong>on_enter</strong>: Runs once when first entering a state</li>
<li><strong>on_exit</strong>: Runs once when exiting a state</li>
<li><strong>on_update</strong>: Runs exactly once on every run of the stage (after any on_enter or on_exit events have been run)</li>
</ul>
<p>You can queue a state change from a system like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">state</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ResMut<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-meta z-generic z-rust">State<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>AppState<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    state<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_next</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">AppState<span class="z-punctuation z-accessor z-rust">::</span></span>InGame</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>Queued state changes get applied at the end of the <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.StateStage.html"><code>StateStage</code></a>. If you change state within a <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.StateStage.html"><code>StateStage</code></a>, the lifecycle events will occur in the same update/frame. You can do this any number of times (aka it will continue running state lifecycle systems until no more changes are queued). This ensures that multiple state changes can be applied within the same frame.</p>
<h2 id="gltf-improvements">GLTF Improvements
<a class="anchor-link" href="#gltf-improvements">#</a>
</h2>
<div class="release-feature-authors">authors: @iwikal, @FuriouZz, @rod-salazar</div>
<p>Bevy's GLTF loader now imports Cameras. Here is a simple scene setup in Blender:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/gltf_camera_blender.png" alt="gltf_camera_blender" /></p>
<p>And here is how it looks in Bevy (the lighting is different because we don't import lights yet):</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/gltf_camera_bevy.png" alt="gltf_camera_bevy" /></p>
<p>There were also a number of other improvements:</p>
<ul>
<li>Pixel format conversion while importing images from a GLTF</li>
<li>Default material loading</li>
<li>Hierarchy fixes</li>
</ul>
<h2 id="spawn-scenes-as-children">Spawn Scenes as Children
<a class="anchor-link" href="#spawn-scenes-as-children">#</a>
</h2>
<div class="release-feature-authors">authors: @mockersf</div>
<p>Scenes can now be spawned as children like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">commands
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Transform<span class="z-punctuation z-accessor z-rust">::</span></span>from_translation<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">Vec3<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">5</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">GlobalTransform<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_children</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">parent</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">        parent<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_scene</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>scene.gltf<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<p>By spawning beneath a parent, this enables you to do things like translate/rotate/scale multiple instances of the same scene:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/scene_children.png" alt="scene_children" /></p>
<h2 id="dynamic-linking">Dynamic Linking
<a class="anchor-link" href="#dynamic-linking">#</a>
</h2>
<div class="release-feature-authors">authors: @bjorn3, @cart</div>
<p>@bjorn3 discovered that you can force Bevy to dynamically link.</p>
<p>This <em>significantly</em> reduces iterative compile times. Check out how long it takes to compile a change made to the <code>3d_scene.rs</code> example with the <a href="https://bevyengine.org/learn/quick-start/getting-started/setup/">Fast Compiles Config</a> <em>and</em> dynamic linking:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/dynamic_fast.png" alt="fast dynamic" /></p>
<h3 id="time-to-compile-change-to-3d-scene-example-in-seconds-less-is-better">Time To Compile Change To 3d_scene Example (in seconds, less is better)
<a class="anchor-link" href="#time-to-compile-change-to-3d-scene-example-in-seconds-less-is-better">#</a>
</h3>
<p><img src="https://bevyengine.org/news/bevy-0-4/fast_compiles.svg" alt="fast_compiles" /></p>
<p>We added a cargo feature to easily enable dynamic linking during development</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> for a bevy app</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">cargo</span></span><span class="z-meta z-function-call z-arguments z-shell"> run<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>features</span> bevy/dynamic</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> for bevy examples</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">cargo</span></span><span class="z-meta z-function-call z-arguments z-shell"> run<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>features</span> dynamic<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>example</span> breakout</span>
</span></code></pre>
<p>Just keep in mind that you should disable the feature when publishing your game.</p>
<h2 id="text-layout-improvements">Text Layout Improvements
<a class="anchor-link" href="#text-layout-improvements">#</a>
</h2>
<div class="release-feature-authors">authors: @AlisCode, @tigregalis</div>
<p>Prior Bevy releases used a custom, naive text layout system. It had a number of bugs and limitations, such as the infamous &quot;wavy text&quot; bug:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/wavy_text.png" alt="wavy_text" /></p>
<p>The new text layout system uses glyph_brush_layout, which fixes the layout bugs and adds a number of new layout options. Note that the &quot;Fira Sans&quot; font used in the example has some stylistic &quot;waviness&quot; ... this isn't a bug:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/text_layout.png" alt="text_layout" /></p>
<h2 id="renderer-optimization">Renderer Optimization
<a class="anchor-link" href="#renderer-optimization">#</a>
</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>Bevy's render API was built to be easy to use and extend. I wanted to nail down a good API first, but that resulted in a number of performance TODOs that caused some pretty serious overhead.</p>
<p>For <strong>Bevy 0.4</strong> I decided to resolve as many of those TODOs as I could. There is still plenty more to do (like instancing and batching), but Bevy already performs <em>much</em> better than it did before.</p>
<h3 id="incrementalize-everything">Incrementalize Everything
<a class="anchor-link" href="#incrementalize-everything">#</a>
</h3>
<p>Most of Bevy's high level render abstractions were designed to be incrementally updated, but when I was first building the engine, ECS change detection wasn't implemented. Now that we have all of these nice optimization tools, it makes sense to use them!</p>
<p>For the first optimization round, I incrementalized as much as I could:</p>
<ul>
<li>Added change detection to RenderResourceNode, Sprites, and Transforms, which improved performance when those values don't change</li>
<li>Only sync asset gpu data when the asset changes</li>
<li>Share asset RenderResourceBindings across all entities that reference an asset</li>
<li>Mesh provider system now only updates mesh specialization when it needs to</li>
<li>Stop clearing bind groups every frame and remove stale bind groups every other frame</li>
<li>Cache unmatched render resource binding results (which prevents redundant computations per-entity per-frame)</li>
<li>Don't send render pass state change commands when the state has not actually changed</li>
</ul>
<h4 id="frame-time-to-draw-10-000-static-sprites-in-milliseconds-less-is-better">Frame Time to Draw 10,000 Static Sprites (in milliseconds, less is better)
<a class="anchor-link" href="#frame-time-to-draw-10-000-static-sprites-in-milliseconds-less-is-better">#</a>
</h4>
<p><img src="https://bevyengine.org/news/bevy-0-4/bevy_round1_static.svg" alt="bevy_round1_static" /></p>
<h4 id="frame-time-to-draw-10-000-moving-sprites-in-milliseconds-less-is-better">Frame Time to Draw 10,000 Moving Sprites (in milliseconds, less is better)
<a class="anchor-link" href="#frame-time-to-draw-10-000-moving-sprites-in-milliseconds-less-is-better">#</a>
</h4>
<p><img src="https://bevyengine.org/news/bevy-0-4/bevy_round1_dynamic.svg" alt="bevy_round1_dynamic" /></p>
<h3 id="optimize-text-rendering-and-other-immediate-rendering">Optimize Text Rendering (and other immediate rendering)
<a class="anchor-link" href="#optimize-text-rendering-and-other-immediate-rendering">#</a>
</h3>
<p>Text Rendering (and anything else that used the <code>SharedBuffers</code> immediate-rendering abstraction) was <em>extremely</em> slow in prior Bevy releases. This was because the <code>SharedBuffers</code> abstraction was a placeholder implementation that didn't actually share buffers. By implementing the &quot;real&quot; <code>SharedBuffers</code> abstraction, we got a pretty significant text rendering speed boost.</p>
<h4 id="frame-time-to-draw-text-debug-example-in-milliseconds-less-is-better">Frame Time to Draw &quot;text_debug&quot; Example  (in milliseconds, less is better)
<a class="anchor-link" href="#frame-time-to-draw-text-debug-example-in-milliseconds-less-is-better">#</a>
</h4>
<p><img src="https://bevyengine.org/news/bevy-0-4/text_rendering.svg" alt="text_rendering" /></p>
<h3 id="mailbox-vsync">Mailbox Vsync
<a class="anchor-link" href="#mailbox-vsync">#</a>
</h3>
<p>Bevy now uses wgpu's &quot;mailbox vsync&quot; by default. This reduces input latency on platforms that support it.</p>
<h2 id="reflection">Reflection
<a class="anchor-link" href="#reflection">#</a>
</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>Rust has a pretty big &quot;reflection&quot; gap. For those who aren't aware, &quot;reflection&quot; is a class of language feature that enables you to interact with language constructs at runtime. They add a form of &quot;dynamic-ness&quot; to what are traditionally static language concepts.</p>
<p>We have bits and pieces of reflection in Rust, such as <a href="https://doc.rust-lang.org/stable/std/any/struct.TypeId.html"><code>TypeId</code></a> and <a href="https://doc.rust-lang.org/std/any/fn.type_name.html"><code>type_name</code></a>. But when it comes to interacting with datatypes ... we don't have anything yet. This is unfortunate because some problems are inherently dynamic in nature.</p>
<p>When I was first building Bevy, I decided that the engine would benefit from such features. Reflection is a good foundation for scene systems, Godot-like (or Unity-like) property animation systems, and editor inspection tools. I built the <code>bevy_property</code> and <code>bevy_type_registry</code> crates to fill these needs.</p>
<p>They got the job done, but they were custom-tailored to Bevy's needs, were full of custom jargon (rather than reflecting Rust language constructs directly), didn't handle traits, and had a number of fundamental restrictions on how data could be accessed.</p>
<p>In this release we replaced the old <code>bevy_property</code> and <code>bevy_type_registry</code> crates with a new <a href="https://docs.rs/bevy/0.4.0/bevy/reflect/index.html"><code>bevy_reflect</code></a> crate. Bevy Reflect is intended to be a &quot;generic&quot; Rust reflection crate. I'm hoping it will be as useful for non-Bevy projects as it is for Bevy. We now use it for our Scene system, but in the future we will use it for animating Component fields and auto-generating Bevy Editor inspector widgets.</p>
<p>Bevy Reflect enables you to dynamically interact with Rust types by deriving the <a href="https://docs.rs/bevy/0.4.0/bevy/reflect/trait.Reflect.html"><code>Reflect</code></a> trait:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Reflect</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">a</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">u32</span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">b</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Bar<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">c</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Reflect</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Bar</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">value</span><span class="z-punctuation z-separator z-type z-rust">:</span> String
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> I&#39;ll use this value to illustrate `bevy_reflect` features
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> foo <span class="z-keyword z-operator z-assignment z-rust">=</span> Foo <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    a<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">1</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    b<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-macro z-rust">vec!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>Bar <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> value<span class="z-punctuation z-separator z-rust">:</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>hello world<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    c<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-macro z-rust">vec!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">2</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h3 id="interact-with-fields-using-their-names">Interact with Fields Using Their Names
<a class="anchor-link" href="#interact-with-fields-using-their-names">#</a>
</h3>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-arithmetic z-rust">*</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">get_field<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>a<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-keyword z-operator z-arithmetic z-rust">*</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">get_field_mut<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>a<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">2</span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">2</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h3 id="patch-your-types-with-new-values">Patch Your Types With New Values
<a class="anchor-link" href="#patch-your-types-with-new-values">#</a>
</h3>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> dynamic_struct <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">DynamicStruct<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">dynamic_struct<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>a<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">42</span><span class="z-storage z-type z-numeric z-rust">u32</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">dynamic_struct<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>c<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-support z-macro z-rust">vec!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-decimal z-rust">3</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">4</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">5</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">apply</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>dynamic_struct</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">42</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span>c<span class="z-punctuation z-separator z-rust">,</span> <span class="z-support z-macro z-rust">vec!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-decimal z-rust">3</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">4</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">5</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h3 id="look-up-nested-fields-using-path-strings">Look Up Nested Fields Using &quot;Path Strings&quot;
<a class="anchor-link" href="#look-up-nested-fields-using-path-strings">#</a>
</h3>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> value <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-keyword z-operator z-arithmetic z-rust">*</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">get_path<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-support z-type z-rust">String</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>b[0].value<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>value<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">as_str</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>hello world<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h3 id="iterate-over-struct-fields">Iterate Over Struct Fields
<a class="anchor-link" href="#iterate-over-struct-fields">#</a>
</h3>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>i<span class="z-punctuation z-separator z-rust">,</span> value<span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>Reflect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_fields</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">enumerate</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> field_name <span class="z-keyword z-operator z-assignment z-rust">=</span> foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">name_at</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>i</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>value</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> value<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">downcast_ref<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span><span class="z-constant z-other z-placeholder z-rust">{}</span> is a u32 with the value: <span class="z-constant z-other z-placeholder z-rust">{}</span><span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> field_name<span class="z-punctuation z-separator z-rust">,</span> <span class="z-keyword z-operator z-arithmetic z-rust">*</span>value<span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> 
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre>
<h3 id="automatically-serialize-and-deserialize-with-serde">Automatically Serialize And Deserialize With Serde
<a class="anchor-link" href="#automatically-serialize-and-deserialize-with-serde">#</a>
</h3>
<p>This doesn't require manual Serde impls!</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> registry <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">TypeRegistry<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">registry<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">register<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">registry<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">register<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span><span class="z-support z-type z-rust">String</span><span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">registry<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">register<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Bar<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> serializer <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">ReflectSerializer<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>foo<span class="z-punctuation z-separator z-rust">,</span> <span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>registry</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> serialized <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">ron<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">ser<span class="z-punctuation z-accessor z-rust">::</span></span>to_string_pretty<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>serializer<span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">ron<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">ser<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">PrettyConfig<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> deserializer <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">ron<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">de<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">Deserializer<span class="z-punctuation z-accessor z-rust">::</span></span>from_str<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>serialized</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> reflect_deserializer <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">ReflectDeserializer<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>registry</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> value <span class="z-keyword z-operator z-assignment z-rust">=</span> reflect_deserializer<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">deserialize</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span><span class="z-storage z-modifier z-rust">mut</span> deserializer</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> dynamic_struct <span class="z-keyword z-operator z-assignment z-rust">=</span> value<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">take<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>DynamicStruct<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> reflect has its own partal_eq impl
</span></span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">reflect_partial_eq</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>dynamic_struct</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h3 id="trait-reflection">Trait Reflection
<a class="anchor-link" href="#trait-reflection">#</a>
</h3>
<p>You can now call a trait on a given <code>&amp;dyn Reflect</code> reference without knowing the underlying type! This is a form of magic that should probably be avoided in most situations. But in the few cases where it is completely necessary, it is very useful:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Reflect</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">reflect</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">DoThing</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyType</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">value</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">DoThing <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyType</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">do_thing</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> String</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-macro z-rust">format!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span><span class="z-constant z-other z-placeholder z-rust">{}</span> World!<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> <span class="z-variable z-language z-rust">self</span><span class="z-punctuation z-accessor z-dot z-rust">.</span>value<span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">reflect_trait</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-trait z-rust">trait</span> <span class="z-entity z-name z-trait z-rust">DoThing</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">do_thing</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> String</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> First, lets box our type as a Box&lt;dyn Reflect&gt;
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> reflect_value<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Box</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>dyn Reflect<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>MyType <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    value<span class="z-punctuation z-separator z-rust">:</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>Hello<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">to_string</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span> 
</span></span><span class="z-source z-rust"><span class="z-comment z-block z-rust">This means we no longer have direct access to MyType or it methods. We can only call Reflect methods on reflect_value. What if we want to call `do_thing` on our type? We could downcast using reflect_value.get::&lt;MyType&gt;(), but what if we don&#39;t know the type at compile time?
</span></span><span class="z-source z-rust"><span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">*/</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Normally in rust we would be out of luck at this point. Lets use our new reflection powers to do something cool!
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> type_registry <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">TypeRegistry<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">type_registry<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">register<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>MyType<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span>
</span></span><span class="z-source z-rust"><span class="z-comment z-block z-rust">The #[reflect] attribute we put on our DoThing trait generated a new `ReflectDoThing` struct, which implements TypeData. This was added to MyType&#39;s TypeRegistration.
</span></span><span class="z-source z-rust"><span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">*/</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> reflect_do_thing <span class="z-keyword z-operator z-assignment z-rust">=</span> type_registry
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">get_type_data<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>ReflectDoThing<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>reflect_value<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">type_id</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> We can use this generated type to convert our `&amp;dyn Reflect` reference to an `&amp;dyn DoThing` reference
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> my_trait<span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-bitwise z-rust">&amp;</span>dyn DoThing <span class="z-keyword z-operator z-assignment z-rust">=</span> reflect_do_thing<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&amp;</span><span class="z-keyword z-operator z-arithmetic z-rust">*</span>reflect_value</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Which means we can now call do_thing(). Magic!
</span></span><span class="z-source z-rust"><span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span><span class="z-constant z-other z-placeholder z-rust">{}</span><span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> my_trait<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">do_thing</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<h2 id="3d-texture-assets">3D Texture Assets
<a class="anchor-link" href="#3d-texture-assets">#</a>
</h2>
<div class="release-feature-authors">authors: @bonsairobo</div>
<p>The Texture asset now has support for 3D textures. The new <code>array_texture.rs</code> example illustrates how to load a 3d texture and sample from each &quot;layer&quot;.</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/array_texture.png" alt="array_texture" /></p>
<h2 id="logging-and-profiling">Logging and Profiling
<a class="anchor-link" href="#logging-and-profiling">#</a>
</h2>
<div class="release-feature-authors">authors: @superdump, @cart</div>
<p>Bevy finally has built in logging, which is now enabled by default via the new <a href="https://docs.rs/bevy/0.4.0/bevy/log/struct.LogPlugin.html"><code>LogPlugin</code></a>. We evaluated various logging libraries and eventually landed on the new <a href="https://docs.rs/tracing/latest/tracing/"><code>tracing</code></a> crate. <code>tracing</code> is a structured logger that handles async / parallel logging well (perfect for an engine like Bevy), and enables profiling in addition to &quot;normal&quot; logging.</p>
<p>The <a href="https://docs.rs/bevy/0.4.0/bevy/log/struct.LogPlugin.html"><code>LogPlugin</code></a> configures each platform to log to the appropriate backend by default: the terminal on desktop, the console on web, and Android Logs / logcat on Android. We built a new Android <code>tracing</code> backend because one didn't exist yet.</p>
<h3 id="logging">Logging
<a class="anchor-link" href="#logging">#</a>
</h3>
<p>Bevy's internal plugins now generate <code>tracing</code> logs. And you can easily add logs to your own app logic like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> these are imported by default in bevy::prelude::*
</span></span><span class="z-source z-rust"><span class="z-support z-macro z-rust">trace!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>very noisy<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">debug!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>helpful for debugging<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">info!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>helpful information that is worth printing by default<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">warn!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>something bad happened that isn&#39;t a failure, but thats worth calling out<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">error!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>something failed<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<p>These lines result in pretty-printed terminal logs:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/logs.png" alt="logs" /></p>
<p><code>tracing</code> has a ton of useful features like structured logging and filtering. <a href="https://docs.rs/tracing/*/tracing/">Check out their documentation for more info.</a></p>
<h3 id="profiling">Profiling
<a class="anchor-link" href="#profiling">#</a>
</h3>
<p>We have added the option to add &quot;tracing spans&quot; to all ECS systems by enabling the <code>trace</code> feature. We also have built in support for the <code>tracing-chrome</code> extension, which causes Bevy to output traces in the &quot;chrome tracing&quot; format.</p>
<p>If you run your app with <code>cargo run --features bevy/trace,bevy/trace_chrome</code> you will get a json file which can be opened in Chrome browsers by visiting the <code>chrome://tracing</code> url:</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/profiling.png" alt="profiling" /></p>
<p>@superdump added support for those nice &quot;span names&quot; to upstream <code>tracing_chrome</code>.</p>
<h2 id="hidpi">HIDPI
<a class="anchor-link" href="#hidpi">#</a>
</h2>
<div class="release-feature-authors">authors: @mockersf, @blunted2night, @cart</div>
<p>Bevy now handles HIDPI / Retina / high pixel density displays properly:</p>
<ul>
<li>OS-reported pixel density is now taken into account when creating windows. If a Bevy App asks for a 1280x720 window on a 2x pixel density display, it will create a window that is 2560x1440</li>
<li>Window width/height is now reported in &quot;logical units&quot; (1280x720 in the example above). Physical units are still available using the <code>window.physical_width()</code> and <code>window.physical_height()</code> methods.</li>
<li>Window &quot;swap chains&quot; are created using the physical resolution to ensure we still have crisp rendering (2560x1440 in the example above)</li>
<li>Bevy UI has been adapted to handle HIDPI scaling correctly</li>
</ul>
<p>There is still a bit more work to be done here. While Bevy UI renders images and boxes at crisp HIDPI resolutions, text is still rendered using the logical resolution, which means it won't be as crisp as it could be on HIDPI displays.</p>
<h2 id="timer-improvements">Timer Improvements
<a class="anchor-link" href="#timer-improvements">#</a>
</h2>
<div class="release-feature-authors">authors: @amberkowalski, @marcusbuffett, @CleanCut</div>
<p>Bevy's Timer component/resource got a number of quality-of-life improvements: pausing, field accessor methods, ergonomics improvements, and internal refactoring / code quality improvements. Timer Components also no longer tick by default. Timer resources and newtyped Timer components couldn't tick by default, so it was a bit inconsistent to have the (relatively uncommon) &quot;unwrapped component Timer&quot; auto-tick.</p>
<p>The timer API now looks like this:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyTimer</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">timer</span><span class="z-punctuation z-separator z-type z-rust">:</span> Timer,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>build<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>MyTimer <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> a five second non-repeating timer
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            timer<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">Timer<span class="z-punctuation z-accessor z-rust">::</span></span>from_seconds<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">5.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-language z-rust">false</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>timer_system<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">timer_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">time</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span>, <span class="z-variable z-parameter z-rust">my_timer</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ResMut<span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>MyTimer<span class="z-punctuation z-definition z-generic z-end z-rust">&gt;</span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> my_timer<span class="z-punctuation z-accessor z-dot z-rust">.</span>timer<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">tick</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>time<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">delta_seconds</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">just_finished</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>five seconds have passed<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h2 id="task-system-improvements">Task System Improvements
<a class="anchor-link" href="#task-system-improvements">#</a>
</h2>
<div class="release-feature-authors">authors: @aclysma</div>
<p>@aclysma changed how Bevy Tasks schedules work, which increased performance in the <code>breakout.rs</code> example game by <b style="color: rgb(50, 210, 50)">~20%</b> and resolved a <a href="https://github.com/bevyengine/bevy/pull/892">deadlock</a> when a Task Pool is configured to only have one thread. Tasks are now executed on the calling thread immediately when there is only one task to run, which cuts down on the overhead of moving work to other threads / blocking on them to finish.</p>
<h2 id="apple-silicon-support">Apple Silicon Support
<a class="anchor-link" href="#apple-silicon-support">#</a>
</h2>
<div class="release-feature-authors">authors: @frewsxcv, @wyhaya, @scoopr</div>
<p>Bevy now runs on Apple silicon thanks to upstream work on winit (@scoopr) and coreaudio-sys (@wyhaya). @frewsxcv and @wyhaya updated Bevy's dependencies and verified that it builds/runs on Apple's new chips.</p>
<h2 id="new-examples">New Examples
<a class="anchor-link" href="#new-examples">#</a>
</h2>
<h3 id="bevy-contributors">Bevy Contributors
<a class="anchor-link" href="#bevy-contributors">#</a>
</h3>
<div class="release-feature-authors">author: @karroffel</div>
<p>@karroffel added a fun example that represents each Bevy contributor as a &quot;Bevy Bird&quot;. It scrapes the latest contributor list from git.</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/contributors.png" alt="contributors" /></p>
<h3 id="bevymark">BevyMark
<a class="anchor-link" href="#bevymark">#</a>
</h3>
<div class="release-feature-authors">author: @robdavenport</div>
<p>A &quot;bunnymark-style&quot; benchmark illustrating Bevy's sprite rendering performance. This was useful when implementing the renderer optimizations mentioned above.</p>
<p><img src="https://bevyengine.org/news/bevy-0-4/bevymark.png" alt="bevymark" /></p>
<h2 id="change-log">Change Log
<a class="anchor-link" href="#change-log">#</a>
</h2>
<h3 id="added">Added
<a class="anchor-link" href="#added">#</a>
</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/273">add bevymark benchmark example</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/772">gltf: support camera and fix hierarchy</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/789">Add tracing spans to schedules, stages, systems</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/801">add example that represents contributors as bevy icons</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/805">Add received character</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/808">Add bevy_dylib to force dynamic linking of bevy</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/815">Added RenderPass::set_scissor_rect</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/836"><code>bevy_log</code></a>
<ul>
<li>Adds logging functionality as a Plugin.</li>
<li>Changes internal logging to work with the new implementation.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/847">cross-platform main function</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/852">Controllable ambient light color</a>
<ul>
<li>Added a resource to change the current ambient light color for PBR.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/859">Added more basic color constants</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/883">Add box shape</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/894">Expose an EventId for events</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/876">System Inputs, Outputs, and Chaining</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/894">Expose an <code>EventId</code> for events</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/917">Added <code>set_cursor_position</code> to <code>Window</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/926">Added new Bevy reflection system</a>
<ul>
<li>Replaces the properties system</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/928">Add support for Apple Silicon</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/937">Live reloading of shaders</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/940">Store mouse cursor position in Window</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/945">Add removal_detection example</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/946">Additional vertex attribute value types</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/956">Added WindowFocused event</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/979">Tracing chrome span names</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1004">Allow windows to be maximized</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1016">GLTF: load default material</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1026">can spawn a scene from a ChildBuilder, or directly set its parent when spawning it</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1038">add ability to load <code>.dds</code>, <code>.tga</code>, and <code>.jpeg</code> texture formats</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1037">add ability to provide custom a <code>AssetIo</code> implementation</a></li>
</ul>
<h3 id="changed">Changed
<a class="anchor-link" href="#changed">#</a>
</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/691">delegate layout reflection to RenderResourceContext</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/719">Fall back to remove components one by one when failing to remove a bundle</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/761">Port hecs derive macro improvements</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/765">Use glyph_brush_layout and add text alignment support</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/791">upgrade glam and hexasphere</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/798">Flexible ECS Params</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/820">Make Timer.tick return &amp;Self</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/821">FileAssetIo includes full path on error</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/829">Removed ECS query APIs that could easily violate safety from the public interface</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/834">Changed Query filter API to be easier to understand</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/842">bevy_render: delegate buffer aligning to render_resource_context</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/843">wasm32: non-spirv shader specialization</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/863">Renamed XComponents to XBundle</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/864">Check for conflicting system resource parameters</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/887">Tweaks to TextureAtlasBuilder.finish()</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/893">do not spend time drawing text with is_visible = false</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/903">Extend the Texture asset type to support 3D data</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/914">Breaking changes to timer API</a>
<ul>
<li>Created getters and setters rather than exposing struct members.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/931">Removed timer auto-ticking system</a>
<ul>
<li>Added an example of how to tick timers manually.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/932">When a task scope produces &lt;= 1 task to run, run it on the calling thread immediately</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/934">Breaking changes to Time API</a>
<ul>
<li>Created getters to get <code>Time</code> state and made members private.</li>
<li>Modifying <code>Time</code>'s values directly is no longer possible outside of bevy.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/920">Use <code>mailbox</code> instead of <code>fifo</code> for vsync on supported systems</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/947">switch winit size to logical to be dpi independent</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/952">Change bevy_input::Touch API to match similar APIs</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/955">Run parent-update and transform-propagation during the &quot;post-startup&quot; stage (instead of &quot;startup&quot;)</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/958">Renderer Optimization Round 1</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/969">Change<code>TextureAtlasBuilder</code> into expected Builder conventions</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/972">Optimize Text rendering / SharedBuffers</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/973">hidpi swap chains</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/987">optimize asset gpu data transfer</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/995">naming coherence for cameras</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1021">Schedule v2</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1027">Use shaderc for aarch64-apple-darwin</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1033">update <code>Window</code>'s <code>width</code> &amp; <code>height</code> methods to return <code>f32</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1034">Break out Visible component from Draw</a>
<ul>
<li>Users setting <code>Draw::is_visible</code> or <code>Draw::is_transparent</code> should now set <code>Visible::is_visible</code> and <code>Visible::is_transparent</code></li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/1043"><code>winit</code> upgraded from version 0.23 to version 0.24</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1071">set is_transparent to true by default for UI bundles</a></li>
</ul>
<h3 id="fixed">Fixed
<a class="anchor-link" href="#fixed">#</a>
</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/857">Fixed typos in KeyCode identifiers</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/871">Remove redundant texture copies in TextureCopyNode</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/892">Fix a deadlock that can occur when using scope() on ComputeTaskPool from within a system</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/893">Don't draw text that isn't visible</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/895">Use <code>instant::Instant</code> for WASM compatibility</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/897">Fix pixel format conversion in bevy_gltf</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/904">Fixed duplicated children when spawning a Scene</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/905">Corrected behaviour of the UI depth system</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/908">Allow despawning of hierarchies in threadlocal systems</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/948">Fix <code>RenderResources</code> index slicing</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/955">Run parent-update and transform-propagation during the &quot;post-startup&quot; stage</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/966">Fix collision detection by comparing abs() penetration depth</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/997">deal with rounding issue when creating the swap chain</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1023">only update components for entities in map</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/1035">Don't panic when attempting to set shader defs from an asset that hasn't loaded yet</a></li>
</ul>
<h2 id="contributors">Contributors
<a class="anchor-link" href="#contributors">#</a>
</h2>
<p>A huge thanks to the <strong>66 contributors</strong> that made this release (and associated docs) possible!</p>
<ul>
<li>@0x6273</li>
<li>@aclysma</li>
<li>@ak-1</li>
<li>@alec-deason</li>
<li>@AlisCode</li>
<li>@amberkowalski</li>
<li>@bjorn3</li>
<li>@blamelessgames</li>
<li>@blunted2night</li>
<li>@bonsairobo</li>
<li>@cart</li>
<li>@CleanCut</li>
<li>@ColdIce1605</li>
<li>@dallenng</li>
<li>@e00E</li>
<li>@easynam</li>
<li>@frewsxcv</li>
<li>@FuriouZz</li>
<li>@Git0Shuai</li>
<li>@iMplode-nZ</li>
<li>@iwikal</li>
<li>@jcornaz</li>
<li>@Jerald</li>
<li>@joshuajbouw</li>
<li>@julhe</li>
<li>@karroffel</li>
<li>@Keats</li>
<li>@Kurble</li>
<li>@lassade</li>
<li>@lukors</li>
<li>@marcusbuffett</li>
<li>@marius851000</li>
<li>@memoryruins</li>
<li>@MGlolenstine</li>
<li>@milkybit</li>
<li>@MinerSebas</li>
<li>@mkhan45</li>
<li>@mockersf</li>
<li>@Moxinilian</li>
<li>@mrk-its</li>
<li>@mvlabat</li>
<li>@nic96</li>
<li>@no1hitjam</li>
<li>@octtep</li>
<li>@OptimisticPeach</li>
<li>@Plecra</li>
<li>@PrototypeNM1</li>
<li>@rmsthebest</li>
<li>@RobDavenport</li>
<li>@robertwayne</li>
<li>@rod-salazar</li>
<li>@sapir</li>
<li>@sburris0</li>
<li>@sdfgeoff</li>
<li>@shirshak55</li>
<li>@smokku</li>
<li>@steveyen</li>
<li>@superdump</li>
<li>@SvenTS</li>
<li>@tangmi</li>
<li>@thebluefish</li>
<li>@Tiagojdferreira</li>
<li>@tigregalis</li>
<li>@toothbrush7777777</li>
<li>@Veykril</li>
<li>@yrns</li>
</ul>

  </div>
  <script type="module">
  import { enable_image_compare } from '/components.js';

  document.addEventListener("DOMContentLoaded", function () {
    enable_image_compare();
  });
  </script>

    </div>
  </div>

        </div>
      </main>
      <footer class="print:hidden">
        
        <div class="footer__social-container">
          <a class="footer__social" href="https://github.com/bevyengine/bevy">
            <img src="/assets/github-mark-white.svg"
                  alt="Bevy engine's GitHub repo"
                  width="32"
                  height="32" />
          </a>
          <a class="footer__social" href="https://discord.gg/bevy">
            <img src="/assets/discord.svg"
                  alt="Bevy Discord server"
                  width="32"
                  height="32" />
          </a>
          <a class="footer__social" href="https://mastodon.social/@bevy">
            <img src="/assets/mastodon-logo-purple.svg"
                  alt="Bevy Mastodon account"
                  width="32"
                  height="32" />
          </a>
          <a class="footer__social" href="https://twitter.com/BevyEngine">
            <img src="/assets/twitter.svg"
                  alt="Bevy Twitter account"
                  width="32"
                  height="32" />
          </a>
          <a class="footer__social" href="https://www.reddit.com/r/bevy/">
            <img src="/assets/reddit.svg"
                  alt="Bevy subreddit"
                  width="32"
                  height="32" />
          </a>
          <a class="footer__social" href="/atom.xml">
            <img src="/assets/feed.svg"
                  alt="Bevy news feed"
                  width="32"
                  height="32" />
          </a>
        </div>
      </footer>
    </div>
    <script>
    const search_params = new URLSearchParams(window.location.search);
    if (search_params.has("show_drafts") || document.cookie.indexOf("show_drafts") >= 0) {
      if (search_params.get("show_drafts") === "0") {
        document.cookie = "show_drafts=;path=/;expires=Thu, 01 Jan 1970 00:00:00 UTC";
      } else {
        document.cookie = "show_drafts=1;path=/"
        document.body.classList.add('show_drafts');
      }
    }
    </script>
  </body>
</html>
